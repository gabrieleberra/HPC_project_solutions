

N104r = [0.0117127, 0.00590447, 0.00401243, 0.00297178, 0.00238475, 0.002031, 0.00179292, 0.0015695, 0.0014335, 0.00126738, 0.00558847, 0.00383368, 0.00370472, 0.00348392, 0.0033821, 0.00324851, 0.00313251, 0.00306555, 0.00308981, 0.00305984, 0.00139966, 0.00139099, 0.00197757, 0.00124118];
N104c = [0.0117369,0.00591208,0.00397129,0.00302294,0.00246953,0.00210405,0.00185314,0.00167689,0.00155003,0.00145877,0.0062822,0.00184111,0.00184618,0.00187956,0.001911,0.00197282,0.00204923,0.00208955,0.0021769,0.00227135,0.00308909,0.00327671,0.00325783,0.00352735];

N105r = [0.116743, 0.0587441, 0.0402386, 0.0298553, 0.0240069, 0.0204888, 0.0178064, 0.0158375, 0.0141069, 0.0123897, 0.0117942, 0.0159829, 0.0200604, 0.0206648, 0.00934233, 0.00940115, 0.00868917, 0.00827529, 0.00831904, 0.0141445, 0.0122947, 0.0121321, 0.011081, 0.0120604];
N105c = [0.116939,0.0588289,0.0392199,0.0294769,0.0236458,0.0197785,0.0170562,0.0149692,0.0134174,0.0121334,0.0111504,0.010449,0.00982914,0.0092817,0.0088479,0.0084617,0.00817177,0.00788272,0.00769636,0.00748128,0.0123971,0.0130115,0.0177907,0.0139145];

N106r = [1.37993, 0.852964, 0.534794,0.397094,0.3166,0.272118, 0.246518,0.203737,0.203635,0.162163,0.183311,0.172779,0.154478,0.164257,0.146337,0.168609,0.131969,0.146683,0.167417,0.137453,0.138696,0.181752,0.161614,0.11629];
N106c = [1.37732,0.886743,0.597724,0.566476,0.512775,0.513363,0.500773,0.443102,0.507215,0.506619,0.445987,0.4828,0.509962,0.480237,0.47326,0.442053,0.477765,0.484687,0.502316,0.513225,0.482379,0.456235,0.484153,0.462431];

N107r = [13.549,8.68279,5.88231,4.60239,3.20319,3.09252,2.68257,2.32122,2.09336,1.89561,1.81687,1.77822,1.95942,1.52377,1.83734,1.51115,1.51872,1.79592,1.39178,1.21523,1.26804,1.30487,1.63174,1.98685];
N107c = [13.5394,8.7218,5.96696,6.15415,5.0518,4.27452,3.87584,3.76328,3.46276,3.27902,3.55779,3.33987,3.35382,3.63705,3.79382,3.93905,4.02356,4.02597,4.30574,4.43136,4.22251,4.18338,4.28819,4.25024];

N108r = [139.12,89.1451,53.3141,39.3163,30.9979,27.0999,26.9724,22.481,19.8514,19.5047,16.8454,17.1125,14.2208,14.5349,13.1996,14.6184,13.8253,13.5662,16.5439,15.2471,23.2421,23.9223,27.0329,26.3931];
N108c = [139.124,89.3167,61.1189,55.6872,45.3139,46.2808,42.8743,41.8577,41.4777,40.3602,40.9104,40.7739,39.5505,40.883,40.7313,42.4019,44.0415,43.6016,45.3102,47.0689,45.2569,44.1683,43.2116,42.5945];


serialN = [0.0116948,0.116749,1.33646,13.3887,134.353];

N = [100000,1000000,10000000,100000000,1000000000];

thread = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24];

N104rEff = N104r(1)./N104r
N105rEff = N105r(1)./N105r
N106rEff = N106r(1)./N106r
N107rEff = N107r(1)./N107r
N108rEff = N108r(1)./N108r


N104cEff = N104c(1)./N104c
N105cEff = N105c(1)./N105c
N106cEff = N106c(1)./N106c
N107cEff = N107c(1)./N107c
N108cEff = N108c(1)./N108c



Z = [N104cEff;N105cEff;N106cEff;N107cEff;N108cEff];


figure()
surf(thread,N,Z,"FaceColor", "interp","EdgeColor", "interp")
xlabel("Number of threads")
ylabel("N")
zlabel("Time (seconds)")
colorbar
pause()



figure()
surf(thread,N,Z,"FaceColor", "interp","EdgeColor", "interp")
xlabel("Number of threads")
ylabel("N")
zlabel("Time (seconds)")
colorbar

pause()

figure()
semilogx(N, serialN,'Linewidth',2)
grid on 
xlabel("N")
ylabel("Time serial (seconds)")


figure()
semilogy(thread, N104c,'Linewidth',2)
hold on 
semilogy(thread, N105c,'Linewidth',2)
hold on 
semilogy(thread, N106c, 'Linewidth',2)
hold on 
semilogy(thread, N107c, 'Linewidth',2)
hold on 
semilogy(thread, N108c, 'Linewidth',2)
legend("N = 1e5","N = 1e6","N = 1e7","N = 1e8","N = 1e9") %
grid on

